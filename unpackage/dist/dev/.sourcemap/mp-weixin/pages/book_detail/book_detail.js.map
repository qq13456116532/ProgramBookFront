{"version":3,"sources":["uni-app:///main.js","webpack:///D:/HBuilder/HBuilderX.2.8.13.20200927/Workplace/book/pages/book_detail/book_detail.vue?29ef","webpack:///D:/HBuilder/HBuilderX.2.8.13.20200927/Workplace/book/pages/book_detail/book_detail.vue?c3e4","webpack:///D:/HBuilder/HBuilderX.2.8.13.20200927/Workplace/book/pages/book_detail/book_detail.vue?1797","webpack:///D:/HBuilder/HBuilderX.2.8.13.20200927/Workplace/book/pages/book_detail/book_detail.vue?d6d9","uni-app:///pages/book_detail/book_detail.vue","webpack:///D:/HBuilder/HBuilderX.2.8.13.20200927/Workplace/book/pages/book_detail/book_detail.vue?d422","webpack:///D:/HBuilder/HBuilderX.2.8.13.20200927/Workplace/book/pages/book_detail/book_detail.vue?9848"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","bookid","isInList","userInfo","commentInputHide","showAllDes","bookDetail","comments","err_page_data","commentType","computed","judgeInlist1","judgeInlist0","onLoad","uni","title","icon","duration","console","key","success","self","fail","methods","getBookDetail","url","tmpData","shortDes","show","image_url","text","buttonText","click","complete","setTimeout","getComments","item","childItem","Util","showAllDesMethod","addLikeNum","commentid","userid","method","addOrRemove","goToReader","readMoreComments","toWriteComment","id","nickname","hideCommentBar","stageCommentValue","sendComment","father","content","rootComment","avatar","isLike","likenum","isOpenMoreComment","time","child","reply","isFind","array"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,oBAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAwH;AACxH;AAC+D;AACL;AACgB;;;AAG1E;AACmL;AACnL,gBAAgB,uLAAU;AAC1B,EAAE,iFAAM;AACR,EAAE,sFAAM;AACR,EAAE,+FAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,0FAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACRA;AAAA;AAAA;AAAA;AAAwrB,CAAgB,uqBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;AC0G5sB;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;eACA;EACAC;IACA;MACAC;MACAC;MAAA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAAA;MACAC;IACA;EACA;EACAC;IACA;IACAC;MACA;IACA;IACA;IACAC;MACA;IACA;EACA;EACAC;IACA;IACA;IACAC;MACAC;MACAC;MACAC;IACA;IACAC;;IAEA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;;IAEA;IACAJ;MACAK;MACAC;QACAF;QACAG;MACA;MAAAC;QACAJ;MACA;IACA;IACA;IACA;IACA;IACAJ;MACAK;MACAC;QACAF;QACAG;MACA;IACA;IACA;IACA;IACAA;IACAA;EACA;EACAE;IACAC;MACA;MACA;MACAV;QACAW;QACAL;UACA;UACA;UACAF;UACA;YACA;YACA;YACAQ;YACA;YACA;YACA;YACA;YACAA;YACA;cACAC;YACA;YACAD;YACA;YACAL;YACAA;YACAP;cACAC;YACA;YACAM;YACA;YAEAP;cACAW;cACAL;gBACAF;gBACAG;cACA;YAEA;UACA;YACAH;YACAG;cACAO;cACAC;cACAC;cACAC;cACAC;YACA;UACA;QACA;QACAV;UACAJ;UACAG;YACAO;YACAC;YACAC;YACAC;YACAC;UACA;QACA;QACAC;UACA;UACAC;YACApB;UACA;QACA;MACA;IACA;IACAqB;MACA;MACA;MACArB;QACAW;QACAL;UACA;UACA;UACA;YACA;YACA;cACA;cACA;cACAgB;cACA;gBACAA;cACA;cACA;cACAA;gBACA;gBACAC;gBACA;kBACAA;gBACA;cACA;cACA;cACA;cACAD;cACA;YACA;YACAf;UAEA;YACAiB;YAEApB;YACAG;cACAO;cACAC;cACAC;cACAC;cACAC;YACA;UACA;QACA;QACAV;UACAJ;UACAG;YACAO;YACAC;YACAC;YACAC;YACAC;UACA;QACA;QACAC;UACA;UACAC;YACApB;UACA;QACA;MACA;IACA;IACAyB;MACA;QACA;UACA;QACA;UACA;QACA;MACA;IACA;IACAC;MACA;MACA;MACA;MACA;QACA;MACA;MACA;MACA;QACA;UACAvC;UACAwC;UACAC;QACA;QACAxB;QACAvB;UACAgD;UACAlB;UACAzB;UACAoB;YACA;YACAF;YAEA;cACA;gBACAvB;kBACAoB;kBACAC;kBACAC;gBACA;gBACA;cACA;cACAC;cACA;cACA;cACAX;gBACA;kBACA6B;kBACA;gBACA;cACA;cACAf;YACA;cACAiB;YACA;UACA;UACAhB;YACAJ;YACAoB;UACA;QACA;MACA;QACA;UACArC;UACAwC;UACAC;QACA;QACAxB;QACAvB;UACAgD;UACAlB;UACAzB;UACAoB;YACAF;YACA;YACA;YACAX;cACA;gBACA6B;gBACA;cACA;YACA;YACAf;UACA;QACA;MACA;IACA;IACAuB;MACA;MACA;MACA;QACA;QACA;UACAF;UACAzC;QACA;QACAa;UACA6B;UACAlB;UACAzB;UACAoB;YACA;YACA;cACAF;cACAJ;gBACAC;gBACAC;gBACAC;cACA;cACAiB;gBACApB;cACA;cACAO;YACA;cACAiB;YACA;UACA;UACAhB;YACAJ;YACAoB;UACA;QACA;MACA;QACA;QACA;QACA;UACAI;UACAzC;QACA;QACAa;UACA6B;UACAlB;UACAzB;UACAoB;YACA;YACA;cACAF;cACAJ;gBACAC;gBACAC;gBACAC;cACA;cACAiB;gBACApB;cACA;cACAO;YACA;cACAP;gBACAC;gBACAC;gBACAC;cACA;cACAI;YACA;UACA;UACAC;YACAJ;YACAoB;UACA;QACA;MACA;IACA;IACAO;MACA/B;QACAW;MACA;IACA;IACA;IACAqB;MACA;MACA;MACA;MAEA;QACA;QACA;MACA;MACA5B;MACA;MACA;MACAX;QACA;UACA;YACA6B;UACA;YACAA;UACA;QACA;MACA;MACAf;IACA;IACA0B;MACA;MACA;MACA;MACA;MACA;QACA;QACA;UACAC;UACAC;UACAP;QACA;MACA;QACA;QACA;UACAM;UACAC;UACAP;QACA;MACA;IACA;IACAQ;MACA;IAEA;IACAC;MACA;IACA;IACAC;MACAlC;MACA;MACA;MACA;MACA;MACA;MACA;QACAwB;QACA;UACAxB;QACA;MACA;QACAA;MACA;MACA;QACAwB;QACAzC;QACAoD;QACAC;MACA;MACApC;MACA;MACA;QACA;QACAJ;UACAW;UACAkB;UACA3C;UACAoB;YACA;YACAF;YACA;cACA;cACA;gBACAX;kBACAgD;oBACAd;oBACAC;oBACAO;oBACAO;oBACAH;oBACAC;oBACAG;oBACAC;oBACAC;oBACAC;kBACA;kBACAC;gBACA;cACA;gBACAtD;kBACA;kBACA;kBACA;oBACA6B;sBACAK;sBACAC;sBACAO;sBACAO;sBACAH;sBACAC;sBACAQ;sBACAF;oBACA;oBACAG;kBACA;oBACA;oBACA;sBACA3B;wBACA,6BACA3B;0BACAuD;4BACAvB,mBACAA;4BACAC;4BACAO;4BACAO,sBACAA;4BACAH,aACA5C;4BACA6C;4BACAQ,wBACAb;4BACAW,gCACA;0BACA;wBACA;sBACA;sBACAG;oBACA;kBACA;kBACA;kBACA;oBACA3B;kBACA;gBACA;cACA;cACA;cACAf;cACAA;cACAP;gBACAC;gBACAC;gBACAC;cACA;cACAiB;gBACApB;cACA;YACA;cACAI;cACAoB;YACA;UACA;UACAhB;YACAJ;YACAoB;UACA;QACA;MACA,SAEA;IACA;EACA;AAEA;AAAA,2B;;;;;;;;;;;;;AC9oBA;AAAA;AAAA;AAAA;AAAowC,CAAgB,gqCAAG,EAAC,C;;;;;;;;;;;ACAxxC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/book_detail/book_detail.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/book_detail/book_detail.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./book_detail.vue?vue&type=template&id=481a20d6&\"\nvar renderjs\nimport script from \"./book_detail.vue?vue&type=script&lang=js&\"\nexport * from \"./book_detail.vue?vue&type=script&lang=js&\"\nimport style0 from \"./book_detail.vue?vue&type=style&index=0&lang=stylus&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/book_detail/book_detail.vue\"\nexport default component.exports","export * from \"-!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./book_detail.vue?vue&type=template&id=481a20d6&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./book_detail.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./book_detail.vue?vue&type=script&lang=js&\"","<template>\r\n\t<view class=\"book-detail-container\">\r\n\t\t<view class=\"headBackgroundContainer\">\r\n\t\t\t<!-- \t<view class=\"headBackground\" :style=\"background:url(bookDetail.headImage) no-repeat center;background-size:200%;\" > \r\n\t\t\t</view> -->\r\n\t\t\t<view class=\"headBackground\"\r\n\t\t\t\t:style=\"'background: url(' + bookDetail.headerImage + ') no-repeat center; background-size: 200%;'\">\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"head\">\r\n\t\t\t<view class=\"bookInfo\">\r\n\t\t\t\t<image class=\"headImg\" :src=\"bookDetail.headerImage\" mode=\"aspectFill\"></image>\r\n\t\t\t\t<view class=\"left-text\">\r\n\t\t\t\t\t<view class=\"bookName\">{{bookDetail.name}}</view>\r\n\t\t\t\t\t<view class=\"author\">作者：{{bookDetail.author}}</view>\r\n\t\t\t\t\t<view class=\"wordsNum\">字数：348.33万</view>\r\n\t\t\t\t\t<view class=\"source\">最新章节：{{bookDetail.newest}}</view>\r\n\t\t\t\t\t<view class=\"updatetime\">更新时间：{{bookDetail.updateTime}}</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"clearfix\"></view>\r\n\t\t\t<view class=\"btn-group\">\r\n\t\t\t\t<view class=\"addToList\" @click=\"addOrRemove\">\r\n\t\t\t\t\t<view class=\"true\" :hidden=\"!isInList == 0\">\r\n\t\t\t\t\t\t<icon class=\"addList-icon\" />加入书架\r\n\t\t\t\t\t</view>\r\n\t\t\t\t\t<view class=\"false\" :hidden=\"!isInList == 1\">\r\n\t\t\t\t\t\t<icon type=\"success_no_circle\" color=\"#fd9941\" size=\"20\" />从书架中移除\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"read\" @click=\"goToReader\">\r\n\t\t\t\t\t<image src=\"../../static/read1.png\"></image>立即阅读\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"book-des\">\r\n\t\t\t<view class=\"des-content\" @click=\"showAllDesMethod\">\r\n\t\t\t\t{{showAllDes || !bookDetail.shortDes ? bookDetail.des : bookDetail.shortDes}}\r\n\t\t\t\t<text class=\"read-more\" :hidden=\"showAllDes || !bookDetail.shortDes\">阅读全部 </text>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"splitor\"></view>\r\n\t\t<view class=\"comments\">\r\n\t\t\t<view class=\"title\">精彩评论<text class=\"add-comment\" @click=\"toWriteComment\">写评论</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"comment-list\">\r\n\t\t\t\t<view v-if=\"comments.length > 0\" class=\"comment-item\" v-for=\"item in comments\"\r\n\t\t\t\t\t:data-commentid=\"item.rootComment.commentid\" :key=\"item.rootComment.commentid\">\r\n\t\t\t\t\t<image class=\"headImg\" :src=\"item.rootComment.avatar\" mode=\"scaleToFill\"></image>\r\n\t\t\t\t\t<view class=\"comment-right\">\r\n\t\t\t\t\t\t<view class=\"reader-name\" :data-userid=\"item.rootComment.userid\">{{item.rootComment.nickname}}\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"create-time\">{{item.rootComment.time}}</view>\r\n\t\t\t\t\t\t<view class=\"comment\">{{item.rootComment.content}}</view>\r\n\t\t\t\t\t\t<view class=\"comment-more\" v-if=\"item.child.length > 0\" @click=\"readMoreComments\"\r\n\t\t\t\t\t\t\t:data-commentid=\"item.rootComment.commentid\">{{'查看' + item.child.length + '回复 >'}}</view>\r\n\t\t\t\t\t\t<view class=\"childComments\" v-if=\"item.child.length > 0\"\r\n\t\t\t\t\t\t\t:hidden=\"!item.rootComment.isOpenMoreComment\">\r\n\t\t\t\t\t\t\t<view class=\"child-item\" v-for=\"(childItem, i) in item.child\" :key=\"childItem.commentid\"\r\n\t\t\t\t\t\t\t\t:data-commentid=\"childItem.commentid\" :data-nickname=\"childItem.nickname\"\r\n\t\t\t\t\t\t\t\t:data-userid=\"childItem.userid\" @click=\"toWriteComment\">\r\n\t\t\t\t\t\t\t\t{{childItem.nickname}} 回复 {{childItem.reply}} ： {{childItem.content}}\r\n\t\t\t\t\t\t\t\t<text class=\"childItem-time\">{{childItem.time}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"toolbar\">\r\n\t\t\t\t\t\t\t<!-- <icon :class=\"item.rootComment.isLike==1 ? 'like-selected-icon' : 'like-icon'\"\r\n\t\t\t\t\t\t\t\t@click=\"addLikeNum\" :data-commentid=\"item.rootComment.commentid\" /> -->\r\n\t\t\t\t\t\t\t\t<icon :class=\"item.rootComment.isLike==1 ? 'iconfont icon-selectetd' : 'iconfont icon-like'\"\r\n\t\t\t\t\t\t\t\t\t@click=\"addLikeNum\" :data-commentid=\"item.rootComment.commentid\" />\r\n\t\t\t\t\t\t\t<text class=\"likeNum\">{{item.rootComment.likenum || 0}}</text>\r\n\t\t\t\t\t\t\t<icon class=\"iconfont reply\" :data-commentid=\"item.rootComment.commentid\"\r\n\t\t\t\t\t\t\t\t:data-nickname=\"item.rootComment.nickname\" :data-userid=\"item.rootComment.userid\"\r\n\t\t\t\t\t\t\t\t@click=\"toWriteComment\" />\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view class=\"no-comments\" v-if=\"comments.length == 0\">\r\n\t\t\t\t\t<image src=\"https://wk-gulimall.oss-cn-beijing.aliyuncs.com/shafa.jfif\"></image>\r\n\t\t\t\t\t暂无评论，快去抢沙发...\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t\t<view class=\"commnet-input-bar\" :hidden=\"commentInputHide\">\r\n\t\t\t<input class=\"comment-input\" :value=\"currentCommentValue\" placeholder=\"发表评论\"\r\n\t\t\t\tplaceholder-class=\"commentInputP\" :focus=\"!commentInputHide\" maxlength=\"100\" @blur=\"hideCommentBar\"\r\n\t\t\t\t@confirm=\"sendComment\" confirm-type=\"send\"></input>\r\n\t\t\t<view class=\"cancle\" @click=\"hideCommentBar\">取消</view>\r\n\t\t</view>\r\n\r\n\t\t<!-- 出错打印 -->\r\n\t\t<import src=\"../component/err_tips/err_tips.wxml\" />\r\n\t\t<template is=\"err_tips\" :data=\"err_tips_data\" />\r\n\r\n\t\t<!-- 成功的提示 -->\r\n\t\t<import src=\"../component/toast/toast.wxml\" />\r\n\t\t<template is=\"toast\" :data=\"toast_data\" />\r\n\r\n\t\t<!-- app状态页 -->\r\n\t\t<import src=\"../component/err_page/err_page.wxml\" />\r\n\t\t<template is=\"err_page\" :data=\"err_page_data\" />\r\n\t</view>\r\n\r\n</template>\r\n\r\n<script>\r\n\timport Api from '../../utils/api/api.js';\r\n\timport Util from '../../utils/util.js';\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tbookid: null,\r\n\t\t\t\tisInList: 0, // 是否已经在书架中\r\n\t\t\t\tuserInfo: null,\r\n\t\t\t\tcommentInputHide: true,\r\n\t\t\t\tshowAllDes: false,\r\n\t\t\t\tbookDetail: null,\r\n\t\t\t\tcomments: [],\r\n\t\t\t\terr_page_data: null, //app状态页\r\n\t\t\t\tcommentType: 'root'\r\n\t\t\t};\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t// isInList == 1 19\r\n\t\t\tjudgeInlist1() {\r\n\t\t\t\treturn this.isInList == 1;\r\n\t\t\t},\r\n\t\t\t// isInList == 0\r\n\t\t\tjudgeInlist0() {\r\n\t\t\t\treturn this.isInList == 0;\r\n\t\t\t},\r\n\t\t},\r\n\t\tonLoad(options) {\r\n\t\t\tvar self = this;\r\n\t\t\t// show loading\r\n\t\t\tuni.showToast({\r\n\t\t\t\ttitle: '加载中',\r\n\t\t\t\ticon: 'loading',\r\n\t\t\t\tduration: 0\r\n\t\t\t});\r\n\t\t\tconsole.log(\"打印一下options\", options)\r\n\r\n\t\t\t// 只有url中带了是否在书架的参数才去更新isInList的值\r\n\t\t\t// if (options.hasOwnProperty('isInList')) {\r\n\t\t\t// \tif (options.isInList === '0' || options.isInList === '1')\r\n\t\t\t// \t\tthis.isInList = parseInt(options.isInList)\r\n\t\t\t// } else {\r\n\t\t\t// \tvar booklist = uni.getStorageSync('booklist');\r\n\t\t\t// \tvar isInMyBook = booklist ? booklist.some(function(item) {\r\n\t\t\t// \t\treturn item.bookid === options.bookid;\r\n\t\t\t// \t}) : false;\r\n\t\t\t// \tthis.isInList = isInMyBook ? 1 : 0;\r\n\t\t\t// }\r\n\r\n\t\t\t// 获取userid和用户信息\r\n\t\t\tuni.getStorage({\r\n\t\t\t\tkey:\"userInfo\",\r\n\t\t\t\tsuccess(res) {\r\n\t\t\t\t\tconsole.log(\"getStorage获取userInfo\",res)\r\n\t\t\t\t\tself.userInfo = res.data\r\n\t\t\t\t},fail(res) {\r\n\t\t\t\t\tconsole.log('huoqu 失败',res)\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\t// var openid = uni.getStorageSync(\"openid\")\r\n\t\t\t// console.log(\"openid是\",openid)\r\n\t\t\t// self.userInfo.openid = openid\r\n\t\t\tuni.getStorage({\r\n\t\t\t\tkey:\"openid\",\r\n\t\t\t\tsuccess(res) {\r\n\t\t\t\t\tconsole.log(\"openid是\",res.data)\r\n\t\t\t\t\tself.userid = res.data\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t\tthis.showAllDes = false;\r\n\t\t\tthis.bookid = options.bookid;\r\n\t\t\tself.getBookDetail();\r\n\t\t\tself.getComments(options.bookid);\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tgetBookDetail: function() {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar bookid = this.bookid;\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: Api.getBookDetail(bookid),\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t// console.log(\"getBookDetail执行成功\",res)\r\n\t\t\t\t\t\tvar tmpData = res.data;\r\n\t\t\t\t\t\tconsole.log(\"getBookDetail的tmpData是\",tmpData)\r\n\t\t\t\t\t\tif (tmpData && tmpData.code == 200) {\r\n\t\t\t\t\t\t\t//格式化日期\r\n\t\t\t\t\t\t\tvar date = new Date(tmpData.data.updateTime);\r\n\t\t\t\t\t\t\ttmpData.data.updateTime = Util.formatDate3(date);\r\n\t\t\t\t\t\t\t// devide des into shortDes and des;\r\n\t\t\t\t\t\t\tvar shortDes = '';\r\n\t\t\t\t\t\t\t// format des\r\n\t\t\t\t\t\t\tvar des = tmpData.data.des;\r\n\t\t\t\t\t\t\ttmpData.data.des = des.replace(/( ){2,}/, ' ');\r\n\t\t\t\t\t\t\tif (des.length > 95) {\r\n\t\t\t\t\t\t\t\tshortDes = des.substring(0, 76);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\ttmpData.data.shortDes = shortDes;\r\n\t\t\t\t\t\t\t// console.log(\"看一下修改以后的tmpData\", tmpData)\r\n\t\t\t\t\t\t\tself.bookDetail = tmpData.data\r\n\t\t\t\t\t\t\tself.err_page_data = null\r\n\t\t\t\t\t\t\tuni.setNavigationBarTitle({\r\n\t\t\t\t\t\t\t\ttitle: tmpData.data.factionName\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tself.bookDetail.name = tmpData.data.factionName\r\n\t\t\t\t\t\t\tvar userid= uni.getStorageSync(\"openid\")\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\t\t\turl:Api.GetJudgeIsInList(userid,bookid),\r\n\t\t\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\t\t\tconsole.log(\"GetJudgeIsInList的结果是\",res.data)\r\n\t\t\t\t\t\t\t\t\tself.isInList = res.data.data\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconsole.log('请求书籍信息失败....');\r\n\t\t\t\t\t\t\tself.err_page_data = {\r\n\t\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\t\timage_url: 'https://file.lantingshucheng.com/myapp/err_tips/network_err.png',\r\n\t\t\t\t\t\t\t\ttext: '努力找不到网络>_<请检查后重试',\r\n\t\t\t\t\t\t\t\tbuttonText: '重试',\r\n\t\t\t\t\t\t\t\tclick: 'getBookDetail'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\tself.err_page_data = {\r\n\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\timage_url: 'https://file.lantingshucheng.com/myapp/err_tips/network_err.png',\r\n\t\t\t\t\t\t\ttext: '努力找不到网络>_<请检查后重试',\r\n\t\t\t\t\t\t\tbuttonText: '登录',\r\n\t\t\t\t\t\t\tclick: 'getBookDetail'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: function() {\r\n\t\t\t\t\t\t//hide loading\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\tuni.hideToast()\r\n\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tgetComments: function(bookid) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar openid=uni.getStorageSync('openid');\r\n\t\t\t\tuni.request({\r\n\t\t\t\t\turl: Api.listComments(bookid)+ \"&openid=\"+openid,\r\n\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\tvar tmpData = res.data;\r\n\t\t\t\t\t\t// console.log(\"打印一下评论\",tmpData)\r\n\t\t\t\t\t\tif (tmpData && tmpData.code == 200) {\r\n\t\t\t\t\t\t\t// 格式化日期\r\n\t\t\t\t\t\t\tvar finalData = tmpData.data.map(function(item) {\r\n\t\t\t\t\t\t\t\t// rootComment\r\n\t\t\t\t\t\t\t\tvar rootDate = new Date(item.rootComment.time);\r\n\t\t\t\t\t\t\t\titem.rootComment.time = Util.formatDate3(rootDate);\r\n\t\t\t\t\t\t\t\tif (item.rootComment.userid == uni.getStorageSync('openid')) {\r\n\t\t\t\t\t\t\t\t\titem.rootComment.nickname = \"我\"\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// child\r\n\t\t\t\t\t\t\t\titem.child.forEach(function(childItem) {\r\n\t\t\t\t\t\t\t\t\tvar childDate = new Date(childItem.time);\r\n\t\t\t\t\t\t\t\t\tchildItem.time = Util.formatDate3(childDate);\r\n\t\t\t\t\t\t\t\t\tif (childItem.userid == uni.getStorageSync('openid')) {\r\n\t\t\t\t\t\t\t\t\t\tchildItem.nickname = \"我\"\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t// isLike and isOpenMoreComment\r\n\t\t\t\t\t\t\t\t// item.rootComment.isLike = 0;\r\n\t\t\t\t\t\t\t\titem.rootComment.isOpenMoreComment = 0;\r\n\t\t\t\t\t\t\t\treturn item;\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tself.comments = finalData\r\n\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tUtil.showErrMsg(self, '请求评论失败!', 1000);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tconsole.log('请求评论失败....');\r\n\t\t\t\t\t\t\tself.err_page_data= {\r\n\t\t\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\t\t\timage_url: 'https://file.lantingshucheng.com/myapp/err_tips/network_err.png',\r\n\t\t\t\t\t\t\t\t\ttext: '努力找不到网络>_<请检查后重试',\r\n\t\t\t\t\t\t\t\t\tbuttonText: '重试',\r\n\t\t\t\t\t\t\t\t\tclick: 'getBookDetail'\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\tself.err_page_data={\r\n\t\t\t\t\t\t\t\tshow: true,\r\n\t\t\t\t\t\t\t\timage_url: 'https://file.lantingshucheng.com/myapp/err_tips/network_err.png',\r\n\t\t\t\t\t\t\t\ttext: '努力找不到网络>_<请检查后重试',\r\n\t\t\t\t\t\t\t\tbuttonText: '重试',\r\n\t\t\t\t\t\t\t\tclick: 'getBookDetail'\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t},\r\n\t\t\t\t\tcomplete: function() {\r\n\t\t\t\t\t\t//hide loading\r\n\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\tuni.hideToast()\r\n\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\tshowAllDesMethod: function() {\r\n\t\t\t\tif (this.bookDetail.shortDes) {\r\n\t\t\t\t\tif (this.showAllDes) {\r\n\t\t\t\t\t\tthis.showAllDes = false;\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.showAllDes = true;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\taddLikeNum: function(e) {\r\n\t\t\t\t// console.log(\"当前在执行addLikeNum\",e)\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar commentid = e.target.dataset.commentid;\r\n\t\t\t\tvar isInLikeArr = self.comments.some(function(item) {\r\n\t\t\t\t\treturn commentid === item.rootComment.commentid && item.rootComment.isLike\r\n\t\t\t\t});\r\n\t\t\t\t// 如果已经点赞了，就不重复发接口了\r\n\t\t\t\tif (!isInLikeArr) {\r\n\t\t\t\t\tvar addLikeData = {\r\n\t\t\t\t\t\tbookid: self.bookid,\r\n\t\t\t\t\t\tcommentid: commentid,\r\n\t\t\t\t\t\tuserid: self.userid\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconsole.log(\"看一下addLikeData\",addLikeData)\r\n\t\t\t\t\twx.request({\r\n\t\t\t\t\t  method: 'post',\r\n\t\t\t\t\t  url: Api.addLikeNum(),\r\n\t\t\t\t\t  data: addLikeData,\r\n\t\t\t\t\t  success: function (res) {\r\n\t\t\t\t\t    var tmpData = res.data;\r\n\t\t\t\t\t\tconsole.log(\"看一下tmpData\",tmpData)\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t    if (tmpData && tmpData.code === 200) {\r\n\t\t\t\t\t\t\tif(tmpData.data==0){\r\n\t\t\t\t\t\t\t\twx.showToast({\r\n\t\t\t\t\t\t\t\t  title: '已经点赞',\r\n\t\t\t\t\t\t\t\t  icon: 'error',\r\n\t\t\t\t\t\t\t\t  duration: 2000\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\treturn;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t      console.log('点赞成功');\r\n\t\t\t\t\t      var comments = self.comments;\r\n\t\t\t\t\t      // 更新comments\r\n\t\t\t\t\t      comments.forEach(function (item) {\r\n\t\t\t\t\t        if (commentid === item.rootComment.commentid) {\r\n\t\t\t\t\t          item.rootComment.isLike = 1;\r\n\t\t\t\t\t          ++item.rootComment.likenum;\r\n\t\t\t\t\t        }\r\n\t\t\t\t\t      })\r\n\t\t\t\t\t\t  self.comments = comments\r\n\t\t\t\t\t    } else {\r\n\t\t\t\t\t      Util.showErrMsg(self, '点赞失败!', 1000);\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t  },\r\n\t\t\t\t\t  fail: function (err) {\r\n\t\t\t\t\t    console.log(err);\r\n\t\t\t\t\t    Util.showErrMsg(self, '点赞失败!', 1000);\r\n\t\t\t\t\t  }\r\n\t\t\t\t\t});\r\n\t\t\t\t}else{\r\n\t\t\t\t\tvar RemoveLikeData = {\r\n\t\t\t\t\t\tbookid: self.bookid,\r\n\t\t\t\t\t\tcommentid: commentid,\r\n\t\t\t\t\t\tuserid: self.userid\r\n\t\t\t\t\t};\r\n\t\t\t\t\tconsole.log(\"看一下RemoveLikeData\",RemoveLikeData)\r\n\t\t\t\t\twx.request({\r\n\t\t\t\t\t  method: 'post',\r\n\t\t\t\t\t  url: Api.RemoveLikeNum(),\r\n\t\t\t\t\t  data: RemoveLikeData,\r\n\t\t\t\t\t  success: function (res) {\r\n\t\t\t\t\t\tconsole.log(\"RemoveLikeNum看一下res\",res)\r\n\t\t\t\t\t      var comments = self.comments;\r\n\t\t\t\t\t      // 更新comments\r\n\t\t\t\t\t      comments.forEach(function (item) {\r\n\t\t\t\t\t        if (commentid === item.rootComment.commentid) {\r\n\t\t\t\t\t          item.rootComment.isLike = 0;\r\n\t\t\t\t\t          --item.rootComment.likenum;\r\n\t\t\t\t\t        }\r\n\t\t\t\t\t      })\r\n\t\t\t\t\t\t  self.comments = comments\r\n\t\t\t\t\t  }\r\n\t\t\t\t\t});\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\taddOrRemove: function() {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\t// 已在书架的先提示确认是否移除，然后调用deleteMyBook， 不在驾的调用addMyBook\r\n\t\t\t\tif (self.isInList === 1) {\r\n\t\t\t\t\tvar userid= uni.getStorageSync(\"openid\")\r\n\t\t\t\t\tvar deleteData = {\r\n\t\t\t\t\t\tuserid: userid,\r\n\t\t\t\t\t\tbookid: self.bookid\r\n\t\t\t\t\t};\r\n\t\t\t\t\t  uni.request({\r\n\t\t\t\t\t    method: 'post',\r\n\t\t\t\t\t    url: Api.deleteMyBooks(),\r\n\t\t\t\t\t    data: deleteData,\r\n\t\t\t\t\t    success: function (res) {\r\n\t\t\t\t\t      var tmpData = res.data;\r\n\t\t\t\t\t      if (tmpData && tmpData.code === 200) {\r\n\t\t\t\t\t        console.log('将该书已成功从书架中移除');\r\n\t\t\t\t\t        uni.showToast({\r\n\t\t\t\t\t          title: '已从书架移除',\r\n\t\t\t\t\t          icon: 'success',\r\n\t\t\t\t\t          duration: 2000\r\n\t\t\t\t\t        });\r\n\t\t\t\t\t        setTimeout(function () {\r\n\t\t\t\t\t          uni.hideToast();\r\n\t\t\t\t\t        }, 1000);\r\n\t\t\t\t\t\t\tself.isInList = 0;\r\n\t\t\t\t\t      } else {\r\n\t\t\t\t\t        Util.showErrMsg(self, '移除失败!', 1000);\r\n\t\t\t\t\t      }\r\n\t\t\t\t\t    },\r\n\t\t\t\t\t    fail: function (err) {\r\n\t\t\t\t\t      console.log(err);\r\n\t\t\t\t\t      Util.showErrMsg(self, '移除失败!', 1000);\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t  });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar userid= uni.getStorageSync(\"openid\")\r\n\t\t\t\t\t\t// console.log(\"...\",userid)\r\n\t\t\t\t\t  var addData = {\r\n\t\t\t\t\t    userid: userid,\r\n\t\t\t\t\t    bookid: self.bookid\r\n\t\t\t\t\t  };\r\n\t\t\t\t\t  uni.request({\r\n\t\t\t\t\t    method: 'post',\r\n\t\t\t\t\t    url: Api.addMyBooks(),\r\n\t\t\t\t\t    data: addData,\r\n\t\t\t\t\t    success: function (res) {\r\n\t\t\t\t\t      var tmpData = res.data;\r\n\t\t\t\t\t      if (tmpData && tmpData.code === 200) {\r\n\t\t\t\t\t        console.log('该书添加已成功添加至书架',tmpData);\r\n\t\t\t\t\t        uni.showToast({\r\n\t\t\t\t\t          title: '已添加至书架',\r\n\t\t\t\t\t          icon: 'success',\r\n\t\t\t\t\t          duration: 2000\r\n\t\t\t\t\t        });\r\n\t\t\t\t\t        setTimeout(function () {\r\n\t\t\t\t\t          uni.hideToast();\r\n\t\t\t\t\t        }, 1000);\r\n\t\t\t\t\t\t\tself.isInList = 1\r\n\t\t\t\t\t      } else if(tmpData.code === 400){\r\n\t\t\t\t\t        uni.showToast({\r\n\t\t\t\t\t          title: '本书已添加',\r\n\t\t\t\t\t          icon: 'error',\r\n\t\t\t\t\t          duration: 2000\r\n\t\t\t\t\t        });\r\n\t\t\t\t\t\t\tself.isInList = 1;\r\n\t\t\t\t\t      }\r\n\t\t\t\t\t    },\r\n\t\t\t\t\t    fail: function (err) {\r\n\t\t\t\t\t      console.log(err);\r\n\t\t\t\t\t      Util.showErrMsg(self, '添加失败!', 1000);\r\n\t\t\t\t\t    }\r\n\t\t\t\t\t  });\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tgoToReader: function() {\r\n\t\t\t\tuni.navigateTo({\r\n\t\t\t\t\turl: 'reader/reader?bookid=' + this.bookid + '&name=' + this.bookDetail.name\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\t//评论相关\r\n\t\t\treadMoreComments: function(e) {\r\n\t\t\t\tvar self = this;\r\n\t\t\t\t// console.log(e.target)\r\n\t\t\t\tvar commentid = e.target.dataset.commentid;\r\n\r\n\t\t\t\tvar hasOpenMoreComent = self.comments.some(function(item) {\r\n\t\t\t\t\t// console.log(\"看一下每一步的\",commentid,item.rootComment.commentid,item.rootComment.isOpenMoreComment)\r\n\t\t\t\t\treturn commentid === item.rootComment.commentid && item.rootComment.isOpenMoreComment\r\n\t\t\t\t});\r\n\t\t\t\tconsole.log(\"hasOpenMoreComent是\", hasOpenMoreComent)\r\n\t\t\t\tvar comments = self.comments;\r\n\t\t\t\t// 更新comments\r\n\t\t\t\tcomments.forEach(function(item) {\r\n\t\t\t\t\tif (commentid === item.rootComment.commentid) {\r\n\t\t\t\t\t\tif (hasOpenMoreComent) {\r\n\t\t\t\t\t\t\titem.rootComment.isOpenMoreComment = 0;\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\titem.rootComment.isOpenMoreComment = 1;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\tself.comments = comments\r\n\t\t\t},\r\n\t\t\ttoWriteComment: function(e) {\r\n\t\t\t\t// console.log(\"toWriteComment\",e)\r\n\t\t\t\tvar commentid = e.target.dataset.commentid;\r\n\t\t\t\tvar nickname = e.target.dataset.nickname;\r\n\t\t\t\tvar userid = e.target.dataset.userid;\r\n\t\t\t\tif (commentid && nickname && userid) {\r\n\t\t\t\t\tthis.commentInputHide = false;\r\n\t\t\t\t\tthis.commentType = {\r\n\t\t\t\t\t\tid: commentid,\r\n\t\t\t\t\t\tnickname: nickname,\r\n\t\t\t\t\t\tuserid: userid\r\n\t\t\t\t\t};\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.commentInputHide = false;\r\n\t\t\t\t\tthis.commentType = {\r\n\t\t\t\t\t\tid: 'root',\r\n\t\t\t\t\t\tnickname: '',\r\n\t\t\t\t\t\tuserid: ''\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\thideCommentBar: function() {\r\n\t\t\t\tthis.commentInputHide = true;\r\n\r\n\t\t\t},\r\n\t\t\tstageCommentValue: function(e) {\r\n\t\t\t\tthis.currentCommentValue = e.value\r\n\t\t\t},\r\n\t\t\tsendComment: function(e) {\r\n\t\t\t\tconsole.log(\"看一下两种触发方式区别\", e)\r\n\t\t\t\tvar self = this;\r\n\t\t\t\tvar comments = self.comments;\r\n\t\t\t\tvar content = e.detail.value;\r\n\t\t\t\t// console.log(\"content是\",content)\r\n\t\t\t\tvar userid= \"\"\r\n\t\t\t\ttry {\r\n\t\t\t\t\tuserid= uni.getStorageSync(\"openid\")\r\n\t\t\t\t\tif (value) {\r\n\t\t\t\t\t\tconsole.log(userid);\r\n\t\t\t\t\t}\r\n\t\t\t\t} catch (e) {\r\n\t\t\t\t\tconsole.log(e);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t\tvar addCommentData = {\r\n\t\t\t\t\tuserid: userid,\r\n\t\t\t\t\tbookid: self.bookid,\r\n\t\t\t\t\tfather: self.commentType.id,\r\n\t\t\t\t\tcontent: content\r\n\t\t\t\t};\r\n\t\t\t\tconsole.log(\"看一下addCommentData\", addCommentData)\r\n\t\t\t\t// 不能给自己回复\r\n\t\t\t\tif (1 || self.userInfo.userid !== self.commentType.userid) {\r\n\t\t\t\t\t// 调用增加评论的接口\r\n\t\t\t\t\tuni.request({\r\n\t\t\t\t\t\turl: Api.addComment(),\r\n\t\t\t\t\t\tmethod: 'post',\r\n\t\t\t\t\t\tdata: JSON.stringify(addCommentData),\r\n\t\t\t\t\t\tsuccess: function(res) {\r\n\t\t\t\t\t\t\tvar tmpData = res.data;\r\n\t\t\t\t\t\t\tconsole.log(\"tmpData是什么\", tmpData)\r\n\t\t\t\t\t\t\tif (tmpData && tmpData.code == 200) {\r\n\t\t\t\t\t\t\t\t// 评论成功\r\n\t\t\t\t\t\t\t\tif (self.commentType.id === 'root') {\r\n\t\t\t\t\t\t\t\t\tcomments.unshift({\r\n\t\t\t\t\t\t\t\t\t\trootComment: {\r\n\t\t\t\t\t\t\t\t\t\t\tcommentid: tmpData.data,\r\n\t\t\t\t\t\t\t\t\t\t\tuserid: userid,\r\n\t\t\t\t\t\t\t\t\t\t\tnickname: '我',\r\n\t\t\t\t\t\t\t\t\t\t\tavatar: self.userInfo.avatar,\r\n\t\t\t\t\t\t\t\t\t\t\tfather: 'root',\r\n\t\t\t\t\t\t\t\t\t\t\tcontent: content,\r\n\t\t\t\t\t\t\t\t\t\t\tisLike: 0,\r\n\t\t\t\t\t\t\t\t\t\t\tlikenum: 0,\r\n\t\t\t\t\t\t\t\t\t\t\tisOpenMoreComment: 0,\r\n\t\t\t\t\t\t\t\t\t\t\ttime: Util.formatDate3(new Date())\r\n\t\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\t\tchild: []\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tcomments.forEach(function(item) {\r\n\t\t\t\t\t\t\t\t\t\tvar isFind = false;\r\n\t\t\t\t\t\t\t\t\t\t// 先查找root\r\n\t\t\t\t\t\t\t\t\t\tif (item.rootComment.commentid === self.commentType.id) {\r\n\t\t\t\t\t\t\t\t\t\t\titem.child.push({\r\n\t\t\t\t\t\t\t\t\t\t\t\tcommentid: tmpData.commentid,\r\n\t\t\t\t\t\t\t\t\t\t\t\tuserid: userid,\r\n\t\t\t\t\t\t\t\t\t\t\t\tnickname: '我',\r\n\t\t\t\t\t\t\t\t\t\t\t\tavatar: self.userInfo.avatar,\r\n\t\t\t\t\t\t\t\t\t\t\t\tfather: self.commentType.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\tcontent: content,\r\n\t\t\t\t\t\t\t\t\t\t\t\treply: self.commentType.nickname,\r\n\t\t\t\t\t\t\t\t\t\t\t\ttime: Util.formatDate3(new Date())\r\n\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\tisFind = true;\r\n\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t// 再查找child\r\n\t\t\t\t\t\t\t\t\t\t\tif (item.child.length > 0) {\r\n\t\t\t\t\t\t\t\t\t\t\t\titem.child.forEach(function(item2, index, array) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (item2.commentid === self\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t.commentType.id) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tarray.push({\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcommentid: tmpData\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.commentid,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tuserid: userid,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnickname: '我',\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tavatar: self.userInfo\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.avatar,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tfather: self\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.commentType.id,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tcontent: content,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\treply: self.commentType\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t.nickname,\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ttime: Util.formatDate3(\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tnew Date())\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\t\t\t\tisFind = true;\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t//发表评论之后保证isOpenMoreComment是1，即可以看到详细回复\r\n\t\t\t\t\t\t\t\t\t\tif (isFind) {\r\n\t\t\t\t\t\t\t\t\t\t\titem.rootComment.isOpenMoreComment = 1;\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t// 更新书评数组\r\n\t\t\t\t\t\t\t\tself.comments = comments\r\n\t\t\t\t\t\t\t\tself.currentCommentValue = ''\r\n\t\t\t\t\t\t\t\tuni.showToast({\r\n\t\t\t\t\t\t\t\t\ttitle: '发布成功',\r\n\t\t\t\t\t\t\t\t\ticon: 'success',\r\n\t\t\t\t\t\t\t\t\tduration: 0\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tsetTimeout(function() {\r\n\t\t\t\t\t\t\t\t\tuni.hideToast();\r\n\t\t\t\t\t\t\t\t}, 1000)\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tconsole.log('发布....');\r\n\t\t\t\t\t\t\t\tUtil.showErrMsg(self, '发布评论失败', 1000);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tfail: function(err) {\r\n\t\t\t\t\t\t\tconsole.log(err);\r\n\t\t\t\t\t\t\tUtil.showErrMsg(self, '发布评论失败', 1000);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t} else {\r\n\t\t\t\t\tUtil.showErrMsg(self, '请勿给自己回复!', 1000);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t}\r\n</script>\r\n\r\n<style lang=\"stylus\">\r\n\t/* CDN 服务仅供平台体验和调试使用，平台不承诺服务的稳定性，企业客户需下载字体包自行发布使用并做好备份。 */\r\n\t\r\n\t\r\n\t.reply::before{\r\n\t\tcontent: \"\\e644\";\r\n\t\tfont-size: 50rpx;\r\n\t}\r\n\t.icon-selectetd::before{\r\n\t  content: '\\e8c3';\r\n\t}\r\n\t\r\n\t.icon-like::before{\r\n\t  content: '\\e8ad';\r\n\t}\r\n\t.err_page {\r\n\t\tposition: absolute;\r\n\t\tz-index: 10000;\r\n\t\tbackground: #fff;\r\n\t\theight: 100%;\r\n\t\twidth: 100%;\r\n\t\ttop: 0;\r\n\t\tleft: 0;\r\n\t\ttext-align: center;\r\n\t\tcolor: #9c9c9c;\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n\r\n\t.err_page>image {\r\n\t\twidth: 330rpx;\r\n\t\theight: 330rpx;\r\n\t\tmargin-top: 40%;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n\r\n\t.err_page>button {\r\n\t\tmargin-top: 40rpx;\r\n\t\twidth: 180rpx;\r\n\t\tline-height: 60rpx;\r\n\t\theight: 60rpx;\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #fd9941;\r\n\t\tborder: 2rpx solid #fd9941;\r\n\t\tborder-radius: 8rpx;\r\n\t}\r\n\r\n\t.book-detail-container {\r\n\t\tline-height: 1.8;\r\n\t\tfont-size: 12px;\r\n\t}\r\n\r\n\t.headBackgroundContainer {\r\n\t\twidth: 100%;\r\n\t\theight: 484rpx;\r\n\t\toverflow: hidden;\r\n\t\tposition: absolute;\r\n\t\tz-index: -1;\r\n\t}\r\n\r\n\t.headBackground {\r\n\t\tmargin-left: -28rpx;\r\n\t\tmargin-top: -28rpx;\r\n\t\twidth: 110%;\r\n\t\theight: 600rpx;\r\n\t\t-webkit-filter: blur(28rpx) brightness(60%);\r\n\t}\r\n\r\n\t.head {\r\n\t\tcolor: #ffffff;\r\n\t\tfont-size: 24rpx;\r\n\t\tpadding: 40rpx;\r\n\t}\r\n\r\n\t.head .headImg {\r\n\t\twidth: 210rpx;\r\n\t\theight: 290rpx;\r\n\t\tvertical-align: text-top;\r\n\t\tfloat: left;\r\n\t}\r\n\r\n\t.head .bookInfo {\r\n\t\toverflow: auto;\r\n\t\tmargin-bottom: 40rpx;\r\n\t}\r\n\r\n\t.head .bookInfo .left-text {\r\n\t\tcolor: rgba(255, 255, 255, 0.9);\r\n\t\tmargin-left: 40rpx;\r\n\t\tfloat: left;\r\n\t\tdisplay: inline-block;\r\n\t}\r\n\r\n\t.head .bookInfo .left-text .bookName {\r\n\t\tfont-size: 32rpx;\r\n\t\tcolor: #ffffff;\r\n\t\tmargin-bottom: 24rpx;\r\n\t}\r\n\r\n\t.head .bookInfo .left-text view {\r\n\t\tmargin-bottom: 12rpx;\r\n\t}\r\n\r\n\t.head .btn-group {\r\n\t\tline-height: 0rpx;\r\n\t\tfont-size: 0;\r\n\t}\r\n\r\n\t/*两个图标*/\r\n\t.addList-icon {\r\n\t\tbackground-size: 220rpx 220rpx;\r\n\t\tbackground-position: -181rpx 0rpx;\r\n\t\tdisplay: inline-block;\r\n\t\theight: 40rpx;\r\n\t\twidth: 40rpx;\r\n\t\tvertical-align: middle;\r\n\t\tposition: relative;\r\n\t\ttop: -4rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\r\n\t.readNow-icon {\r\n\t\tbackground-size: 400rpx 400rpx;\r\n\t\tbackground-position: 6rpx -76rpx;\r\n\t}\r\n\r\n\t.head .btn-group .addToList,\r\n\t.read {\r\n\t\tfont-size: 28rpx;\r\n\t\tdisplay: inline-block;\r\n\t\tbox-sizing: border-box;\r\n\t\twidth: 315rpx;\r\n\t\tpadding: 20rpx 10rpx;\r\n\t\ttext-align: center;\r\n\t\tbackground: rgba(238,150,17, 0.8);\r\n\t\tborder-radius: 8rpx;\r\n\t\theight: 72rpx;\r\n\t}\r\n\r\n\t.head .btn-group .read {\r\n\t\tmargin-left: 40rpx;\r\n\t}\r\n\r\n\t.head .btn-group .addToList .false icon {\r\n\t\tvertical-align: middle;\r\n\t\tposition: relative;\r\n\t\ttop: -5rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\r\n\t.head .btn-group image {\r\n\t\tvertical-align: text-top;\r\n\t\tmargin-top: -4rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t\theight: 38rpx;\r\n\t\twidth: 38rpx;\r\n\t}\r\n\r\n\t.book-des {\r\n\t\tfont-size: 28rpx;\r\n\t\tpadding: 40rpx;\r\n\t}\r\n\r\n\t.book-des .read-more {\r\n\t\tpadding-left: 10rpx;\r\n\t\tcolor: #fd9941;\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n\r\n\t.book-des .des-content {\r\n\t\ttext-align: justify;\r\n\t}\r\n\r\n\t.comments {}\r\n\r\n\t.comments .title {\r\n\t\tborder-bottom: 1rpx solid #dcdcdc;\r\n\t\tpadding: 0 30rpx;\r\n\t\theight: 80rpx;\r\n\t\tfont-size: 32rpx;\r\n\t\tline-height: 80rpx;\r\n\t}\r\n\r\n\t.comments .title .add-comment {\r\n\t\tcolor: #FD9941;\r\n\t\tfloat: right;\r\n\t}\r\n\r\n\t.comments .comment-list {\r\n\t\tmargin-top: -1rpx;\r\n\t\tbackground: #f5f5f5;\r\n\t}\r\n\r\n\t.comment-item {\r\n\t\tbackground: #ffffff;\r\n\t\tpadding: 20rpx;\r\n\t\tbox-sizing: border-box;\r\n\t\toverflow: auto;\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.comment-item .headImg {\r\n\t\tfloat: left;\r\n\t\twidth: 70rpx;\r\n\t\theight: 70rpx;\r\n\t\tmargin-right: 20rpx;\r\n\t\tborder-radius: 40rpx;\r\n\t\tdisplay: inline-block;\r\n\t\tborder: 1rpx solid #eeeeee;\r\n\t}\r\n\r\n\t.comment-item .comment-right {\r\n\t\tfloat: left;\r\n\t\twidth: 610rpx;\r\n\t\tdisplay: inline-block;\r\n\t\tpadding-bottom: 20rpx;\r\n\t\tborder-bottom: 1rpx solid #e1e1e1;\r\n\t\tposition: relative;\r\n\t}\r\n\r\n\t.comment-item .comment-right .reader-name {\r\n\t\tcolor: #666666;\r\n\t\tfont-size: 24rpx;\r\n\t}\r\n\r\n\t.comment-item .comment-right .comment {\r\n\t\ttext-align: justify;\r\n\t\tcolor: #333;\r\n\t\tfont-size: 26rpx;\r\n\t}\r\n\r\n\t.comment-item .comment-right .comment-more {\r\n\t\tbackground: #efefef;\r\n\t\tfont-size: 22rpx;\r\n\t\tpadding: 4rpx 10rpx;\r\n\t}\r\n\r\n\t.comment-item .comment-right .create-time {\r\n\t\tfont-size: 20rpx;\r\n\t\tcolor: #808080;\r\n\t}\r\n\r\n\t.childComments {\r\n\t\tmargin-top: 10rpx;\r\n\t\tfont-size: 22rpx;\r\n\t}\r\n\r\n\t.childComments .childItem-time {\r\n\t\tpadding-left: 20rpx;\r\n\t\tfont-size: 20rpx;\r\n\t\tcolor: #808080;\r\n\t}\r\n\r\n\t.comment-right .toolbar {\r\n\t\tposition: absolute;\r\n\t\tright: 0;\r\n\t\ttop: 0;\r\n\t}\r\n\r\n\t.comment-right .toolbar icon {\r\n\t\tdisplay: inline-block;\r\n\t\theight: 36rpx;\r\n\t\twidth: 36rpx;\r\n\t\tbackground-size: 180rpx 180rpx;\r\n\t}\r\n\r\n\t.like-icon {\r\n\t\tbackground-position: -107rpx 0rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\r\n\t.like-selected-icon {\r\n\t\tbackground-position: -37rpx 1rpx;\r\n\t\tmargin-right: 10rpx;\r\n\t}\r\n\r\n\t.likeNum {\r\n\t\tposition: relative;\r\n\t\ttop: -8rpx;\r\n\t\tcolor: #808080;\r\n\t\tmargin-left: 19rpx;\r\n\t\tmargin-right: 26rpx;\r\n\t}\r\n\r\n\t.comment-icon {\r\n\t\tbackground-position: -73rpx 0rpx;\r\n\t}\r\n\r\n\t.commnet-input-bar {\r\n\t\theight: 100rpx;\r\n\t\tfont-size: 0;\r\n\t\twidth: 100%;\r\n\t\tpadding: 0 20rpx;\r\n\t\tposition: fixed;\r\n\t\tbottom: 0;\r\n\t\tbackground: #fff4ea;\r\n\t\tbox-sizing: border-box;\r\n\t\tborder-top: 1rpx solid #dcdcdc;\r\n\t}\r\n\r\n\t.comment-input {\r\n\t\theight: 60rpx;\r\n\t\tfont-size: 28rpx;\r\n\t\tpadding: 0 20rpx;\r\n\t\tmargin: 20rpx 0;\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 610rpx;\r\n\t\tbackground: #ffffff;\r\n\t\tborder: 1rpx solid #dcdcdc;\r\n\t\tborder-radius: 10rpx;\r\n\t\tbox-sizing: border-box;\r\n\t}\r\n\r\n\t.commentInputP {\r\n\t\tline-height: 60rpx;\r\n\t}\r\n\r\n\t.commnet-input-bar .cancle {\r\n\t\tdisplay: inline-block;\r\n\t\twidth: 100rpx;\r\n\t\theight: 60rpx;\r\n\t\tcolor: #666666;\r\n\t\tfont-size: 28rpx;\r\n\t\ttext-align: center;\r\n\t\tfloat: right;\r\n\t\tmargin: 20rpx 0;\r\n\t}\r\n\r\n\t.no-comments {\r\n\t\tpadding-top: 50rpx;\r\n\t\ttext-align: center;\r\n\t\theight: 100%;\r\n\t\tbackground: #fff;\r\n\t\tfont-size: 30rpx;\r\n\t}\r\n\r\n\t.no-comments>image {\r\n\t\twidth: 100rpx;\r\n\t\theight: 100rpx;\r\n\t\tdisplay: block;\r\n\t\tmargin: 0rpx auto;\r\n\t\tmargin-bottom: 30rpx;\r\n\t}\r\n</style>\n","import mod from \"-!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--11-oneOf-1-2!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-3!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/stylus-loader/index.js??ref--11-oneOf-1-4!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--11-oneOf-1-5!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./book_detail.vue?vue&type=style&index=0&lang=stylus&\"; export default mod; export * from \"-!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--11-oneOf-1-0!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--11-oneOf-1-1!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--11-oneOf-1-2!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--11-oneOf-1-3!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/stylus-loader/index.js??ref--11-oneOf-1-4!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--11-oneOf-1-5!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../../../HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./book_detail.vue?vue&type=style&index=0&lang=stylus&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1674817294020\n      var cssReload = require(\"D:/HbuilderX/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}